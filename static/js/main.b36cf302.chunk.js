(this["webpackJsonpnew-story-metrics-dashboard"]=this["webpackJsonpnew-story-metrics-dashboard"]||[]).push([[0],{17:function(e,t,n){e.exports=n(49)},22:function(e,t,n){},23:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(15),i=n.n(c),s=(n(22),n(23),n(2)),l=n(3),o=n.n(l),u=n(4),m=n.n(u),f=n(16),d=n(5),h=n.n(d),g=function(e,t,n,a,r){var c=o()().subtract(t[1],"days").format("YYYY-MM-DD"),i={};Object.keys(e).forEach((function(t){var n=e[t].filter((function(e){var t=e.createdAt.indexOf("T");return e.createdAt.substring(0,t)>c}));i[t]=n})),n(i);var s=2*t[1],l=o()().subtract(s,"days").format("YYYY-MM-DD"),u={};Object.keys(e).forEach((function(t){var n=e[t].filter((function(e){var t=e.createdAt.indexOf("T"),n=e.createdAt.substring(0,t);return n>l&&n<c}));u[t]=n})),a(u);var m={};Object.keys(e).forEach((function(t){var n=e[t].filter((function(e){var t=e.createdAt.indexOf("T");return e.createdAt.substring(0,t)<c}));m[t]=n})),r(m)},p={signInUser:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("https://api-dev.newstory.io/graphql",{query:'\n                mutation { signInUser(email: "emauldin84@gmail.com", password:"thrivenotsurvive"){\n                token\n                viewer { \n                    uuid \n                    email \n                    firstName \n                    lastName \n                } \n            } \n        }\n        '},{headers:{"X-Api-Key":"54125abed83236f363b8330eefe6f4e3","Content-Type":"application/json"}}).then((function(e){console.log(e),t(e.data.data.signInUser.token)})).catch((function(e){throw e}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setCompData:g,fetchData:function(e,t,n,a,r,c,i){h.a.post("https://api-dev.newstory.io/graphql",{query:"\n            query {\n                users {\n                    uuid\n                    username\n                    createdAt\n                    lastSignInAt\n                    }\n                organizations{\n                    uuid\n                    name\n                    createdAt\n                    users {\n                        uuid\n                    username\n                        lastSignInAt\n                        }\n                    }\n                recipients{\n                    uuid\n                    name\n                    createdAt\n                    updatedAt\n                }\n                submissions {\n                    uuid\n                    surveyor {\n                        firstName\n                        lastName\n                        username\n                    }\n                    createdAt \n                }\n            }\n        "},{headers:{Authorization:e,"X-Api-Key":"54125abed83236f363b8330eefe6f4e3","Content-Type":"application/json"}}).then((function(e){console.log("CUR DATA ",e.data.data),n(e.data.data),g(e.data.data,t,a,r,c),i(!1)})).catch((function(e){throw e}))}},v=(n(43),n(44),function(e){console.log(e.metrics,"metricsData",e.metricsData);var t=Object.keys(e.metricsData).map((function(t){var n=e.metricsData[t].current,a=Math.abs(e.metricsData[t].comparison),c=n-a,i=c>0?"comparison positive":c<0?"comparison negative":"comparison",s=c>0?"\u2191":c<0?"\u2193":null,l=(Math.abs(c)/Math.abs(a)*100).toFixed(2),o=Math.abs(n)>0&&0===a?"*":null;return r.a.createElement("div",{key:t,className:"metric-inline-display"},r.a.createElement("div",{className:"metric-title-container"},r.a.createElement("p",null,t[0].toUpperCase()+t.substring(1)," ",e.metrics[0].toUpperCase()+e.metrics.substring(1))),r.a.createElement("div",{className:"metric-data-container"},r.a.createElement("p",{className:"current"},n),r.a.createElement("p",{className:i},s,l,"%",o)))}));return r.a.createElement("div",{className:"container"},r.a.createElement("div",{id:e.metrics,className:"metric-container ".concat(e.metrics,"-container"),onClick:e.handleMetricClick},t))}),b=(n(45),n(46),function(e){return r.a.createElement("div",{className:"refresh",title:"refresh data",onClick:function(){e.setFetching(!0),e.fetchData()}},"\u27f3")}),y=function(e){var t="month"===e.frequency[0]?"active frequency month":"frequency month",n="quarter"===e.frequency[0]?"active frequency quarter":"frequency quarter",a="year"===e.frequency[0]?"active frequency year":"frequency year";return r.a.createElement("div",{className:"comparison-container"},r.a.createElement("p",{className:"frequency-title"},"Comparison Frequency"),r.a.createElement("div",{className:"frequency-selector"},r.a.createElement(b,{fetchData:e.fetchData,setFetching:e.setFetching}),r.a.createElement("p",{className:t,onClick:function(){return e.handleFrequencyClick(["month",30])}},"month"),r.a.createElement("p",{className:"divider"},"|"),r.a.createElement("p",{className:n,onClick:function(){return e.handleFrequencyClick(["quarter",91])}},"quarter"),r.a.createElement("p",{className:"divider"},"|"),r.a.createElement("p",{className:a,onClick:function(){return e.handleFrequencyClick(["year",365])}},"year")))},E=(n(47),function(){return r.a.createElement("div",{className:"key-container"},r.a.createElement("p",null,"* Percent change from zero"))}),A=(n(48),function(){return r.a.createElement("div",{className:"loader-backdrop"},r.a.createElement("div",{className:"loader"}),r.a.createElement("div",{className:"loader-text"},"Fetching..."))}),N=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)([]),l=Object(s.a)(i,2),u=l[0],m=l[1],f=Object(a.useState)([]),d=Object(s.a)(f,2),h=d[0],g=d[1],b=Object(a.useState)([]),N=Object(s.a)(b,2),O=N[0],k=N[1],j=Object(a.useState)(["month",30]),q=Object(s.a)(j,2),S=q[0],w=q[1],D=Object(a.useState)(!0),I=Object(s.a)(D,2),C=I[0],Y=I[1],M=Object(a.useState)(null),x=Object(s.a)(M,2),F=x[0],T=x[1],z=Object(a.useState)(!0),U=Object(s.a)(z,2),B=U[0],J=U[1];Object(a.useEffect)((function(){p.signInUser(T)}),[]),Object(a.useEffect)((function(){F&&p.setCompData(n,S,m,g,k)}),[F,S]),Object(a.useEffect)((function(){F&&K()}),[F]);var K=function(){p.fetchData(F,S,c,m,g,k,J)},W={},X=[],L=[],P=[],R=[];Object.keys(n).forEach((function(e){var t=o()().subtract(S[1],"days").format("YYYY-MM-DD"),a=o()().subtract(2*S[1],"days").format("YYYY-MM-DD");"users"===e&&(X=n[e].filter((function(e){var n=e.lastSignInAt?e.lastSignInAt.indexOf("T"):null;return(e.lastSignInAt?e.lastSignInAt.substring(0,n):null)>t})),L=n[e].filter((function(e){var n=e.lastSignInAt?e.lastSignInAt.indexOf("T"):null,r=e.lastSignInAt?e.lastSignInAt.substring(0,n):null;return r>a&&r<t}))),"organizations"===e&&(P=n[e].map((function(e){return e.users.filter((function(e){var n=e.lastSignInAt?e.lastSignInAt.indexOf("T"):null,a=e.lastSignInAt?e.lastSignInAt.substring(0,n):null;return!(a<=t)&&a>t}))})).filter((function(e){return e.length>=1})),R=n[e].map((function(e){return e.users.filter((function(e){var n=e.lastSignInAt?e.lastSignInAt.indexOf("T"):null,r=e.lastSignInAt?e.lastSignInAt.substring(0,n):null;return r>a&&r<t}))})).filter((function(e){return e.length>=1}))),W[e]=u[e]&&h[e]&&O[e]?"organizations"===e||"users"===e?{active:{current:"organizations"===e?P.length:X.length,comparison:"organizations"===e?R.length:L.length},new:{current:u[e].length,comparison:h[e].length},total:{current:n[e].length,comparison:O[e].length}}:{new:{current:u[e].length,comparison:h[e].length},total:{current:n[e].length,comparison:O[e].length}}:null}));var V=Object.keys(W).map((function(e){return r.a.createElement(v,{key:e,metrics:e,metricsData:W[e],frequency:S})})),$=B?r.a.createElement(A,null):r.a.createElement("div",null,V,r.a.createElement(E,null));return r.a.createElement("div",{className:"dashboard-container"},r.a.createElement("div",{className:"logo-container"},r.a.createElement("img",{className:"logo",alt:"New Story Logo",src:"https://360kk73nf60j1amgkj11crnq-wpengine.netdna-ssl.com/wp-content/themes/newstory/src/img/logo.png",onClick:function(){Y(!C)}})),r.a.createElement(y,{handleFrequencyClick:function(e){e[1]!==S[1]&&w(e)},frequency:S,fetchData:K,setFetching:J}),r.a.createElement("div",{className:"title-display"},r.a.createElement("p",{className:"titles",id:"title-metric"},r.a.createElement("b",null,"Metric")),r.a.createElement("p",{className:"titles",id:"title-value"},r.a.createElement("b",null,"Value")),r.a.createElement("p",{className:"titles",id:"title-comparison"},r.a.createElement("b",null,"Comparison"))),$)},O=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(N,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[17,1,2]]]);
//# sourceMappingURL=main.b36cf302.chunk.js.map